['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_2layer_DNN.py", line 108, in <module>
    displayGraphs=False)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/helper.py", line 166, in train_model_and_plot_stats
    output = optimiser.train(num_epochs, stats_interval)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 148, in train
    self.do_training_epoch()
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 74, in do_training_epoch
    self.learning_rule.update_params(grads_wrt_params)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/learning_rules.py", line 235, in update_params
    m += (1. - self.beta_1) * grad
ValueError: operands could not be broadcast together with shapes (720,) (10,5,5,5) (720,) 
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_2layer_DNN.py", line 108, in <module>
    displayGraphs=False)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/helper.py", line 166, in train_model_and_plot_stats
    output = optimiser.train(num_epochs, stats_interval)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 148, in train
    self.do_training_epoch()
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 74, in do_training_epoch
    self.learning_rule.update_params(grads_wrt_params)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/learning_rules.py", line 235, in update_params
    m += (1. - self.beta_1) * grad
ValueError: operands could not be broadcast together with shapes (720,) (10,5,5,5) (720,) 
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_2layer_DNN.py", line 108, in <module>
    displayGraphs=False)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/helper.py", line 166, in train_model_and_plot_stats
    output = optimiser.train(num_epochs, stats_interval)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 148, in train
    self.do_training_epoch()
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 74, in do_training_epoch
    self.learning_rule.update_params(grads_wrt_params)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/learning_rules.py", line 235, in update_params
    m += (1. - self.beta_1) * grad
ValueError: operands could not be broadcast together with shapes (720,) (10,5,5,5) (720,) 
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_2layer_DNN.py", line 108, in <module>
    displayGraphs=False)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/helper.py", line 166, in train_model_and_plot_stats
    output = optimiser.train(num_epochs, stats_interval)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 148, in train
    self.do_training_epoch()
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 74, in do_training_epoch
    self.learning_rule.update_params(grads_wrt_params)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/learning_rules.py", line 235, in update_params
    m += (1. - self.beta_1) * grad
ValueError: operands could not be broadcast together with shapes (720,) (10,5,5,5) (720,) 
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_2layer_DNN.py", line 108, in <module>
    displayGraphs=False)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/helper.py", line 166, in train_model_and_plot_stats
    output = optimiser.train(num_epochs, stats_interval)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 148, in train
    self.do_training_epoch()
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 74, in do_training_epoch
    self.learning_rule.update_params(grads_wrt_params)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/learning_rules.py", line 235, in update_params
    m += (1. - self.beta_1) * grad
ValueError: operands could not be broadcast together with shapes (720,) (10,5,5,5) (720,) 
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_2layer_DNN.py", line 108, in <module>
    displayGraphs=False)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/helper.py", line 166, in train_model_and_plot_stats
    output = optimiser.train(num_epochs, stats_interval)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 148, in train
    self.do_training_epoch()
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 74, in do_training_epoch
    self.learning_rule.update_params(grads_wrt_params)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/learning_rules.py", line 235, in update_params
    m += (1. - self.beta_1) * grad
ValueError: operands could not be broadcast together with shapes (720,) (10,5,5,5) (720,) 
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_2layer_DNN.py", line 108, in <module>
    displayGraphs=False)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/helper.py", line 166, in train_model_and_plot_stats
    output = optimiser.train(num_epochs, stats_interval)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 148, in train
    self.do_training_epoch()
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 74, in do_training_epoch
    self.learning_rule.update_params(grads_wrt_params)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/learning_rules.py", line 235, in update_params
    m += (1. - self.beta_1) * grad
ValueError: operands could not be broadcast together with shapes (720,) (10,5,5,5) (720,) 
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_2layer_DNN.py", line 108, in <module>
    displayGraphs=False)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/helper.py", line 166, in train_model_and_plot_stats
    output = optimiser.train(num_epochs, stats_interval)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 148, in train
    self.do_training_epoch()
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 74, in do_training_epoch
    self.learning_rule.update_params(grads_wrt_params)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/learning_rules.py", line 235, in update_params
    m += (1. - self.beta_1) * grad
ValueError: operands could not be broadcast together with shapes (720,) (10,5,5,5) (720,) 
  File "Coursework_2-PART-B-baseline_1layer-BNDROPOUT_DNN.py", line 85
    ])
    ^
SyntaxError: invalid syntax
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
MultiLayerModel(
    DropoutLayer(incl_prob=0.8)
    ReshapeLayer(output_shape=(1, 28, 28))
    ConvolutionalLayer(
    num_input_channels=1, num_output_channels=5,
    input_dim_1=28, input_dim_2=28,
    kernel_dim_1=5, kernel_dim_2=5
)
    MaxPoolLayer(
    num_input_channels=5,
    input_dim_1=24, input_dim_2=24,
    extent=2, stride=2
)
    ReshapeLayer(output_shape=(720,))
    DropoutLayer(incl_prob=0.8)
    AffineLayer(input_dim=720, output_dim=400)
    ReluLayer
    DropoutLayer(incl_prob=0.8)
    AffineLayer(input_dim=400, output_dim=400)
    ReluLayer
    DropoutLayer(incl_prob=0.8)
    AffineLayer(input_dim=400, output_dim=400)
    ReluLayer
    DropoutLayer(incl_prob=0.8)
    AffineLayer(input_dim=400, output_dim=400)
    ReluLayer
    AffineLayer(input_dim=400, output_dim=47)
)
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_1layer-BNDROPOUT_DNN.py", line 89, in <module>
    learning_rule = MomentumLearningRule()
NameError: name 'MomentumLearningRule' is not defined
Epoch 1: 205.2s to complete
    error(train)=6.91e-01, acc(train)=7.81e-01, error(valid)=7.07e-01, acc(valid)=7.81e-01, error(test)=7.34e-01, acc(test)=7.64e-01
Epoch 2: 205.2s to complete
    error(train)=5.57e-01, acc(train)=8.07e-01, error(valid)=5.80e-01, acc(valid)=7.99e-01, error(test)=6.08e-01, acc(test)=7.87e-01
Epoch 3: 208.7s to complete
    error(train)=5.20e-01, acc(train)=8.24e-01, error(valid)=5.53e-01, acc(valid)=8.16e-01, error(test)=5.79e-01, acc(test)=8.06e-01
Epoch 4: 204.6s to complete
    error(train)=4.51e-01, acc(train)=8.42e-01, error(valid)=4.95e-01, acc(valid)=8.27e-01, error(test)=5.18e-01, acc(test)=8.20e-01
Epoch 5: 205.0s to complete
    error(train)=4.51e-01, acc(train)=8.37e-01, error(valid)=4.95e-01, acc(valid)=8.29e-01, error(test)=5.33e-01, acc(test)=8.16e-01
Epoch 6: 210.5s to complete
    error(train)=4.44e-01, acc(train)=8.41e-01, error(valid)=4.98e-01, acc(valid)=8.28e-01, error(test)=5.32e-01, acc(test)=8.18e-01
Epoch 7: 206.3s to complete
    error(train)=4.02e-01, acc(train)=8.55e-01, error(valid)=4.62e-01, acc(valid)=8.44e-01, error(test)=4.97e-01, acc(test)=8.31e-01
Epoch 8: 204.5s to complete
    error(train)=5.25e-01, acc(train)=8.18e-01, error(valid)=5.86e-01, acc(valid)=8.06e-01, error(test)=6.18e-01, acc(test)=7.90e-01
Epoch 9: 207.8s to complete
    error(train)=4.47e-01, acc(train)=8.43e-01, error(valid)=5.20e-01, acc(valid)=8.23e-01, error(test)=5.49e-01, acc(test)=8.14e-01
Epoch 10: 219.9s to complete
    error(train)=4.58e-01, acc(train)=8.38e-01, error(valid)=5.30e-01, acc(valid)=8.22e-01, error(test)=5.62e-01, acc(test)=8.09e-01
Epoch 11: 204.5s to complete
    error(train)=3.70e-01, acc(train)=8.64e-01, error(valid)=4.57e-01, acc(valid)=8.41e-01, error(test)=4.83e-01, acc(test)=8.32e-01
Epoch 12: 217.5s to complete
    error(train)=3.71e-01, acc(train)=8.58e-01, error(valid)=4.50e-01, acc(valid)=8.40e-01, error(test)=4.82e-01, acc(test)=8.30e-01
Epoch 13: 204.1s to complete
    error(train)=3.68e-01, acc(train)=8.66e-01, error(valid)=4.60e-01, acc(valid)=8.45e-01, error(test)=4.90e-01, acc(test)=8.33e-01
Epoch 14: 204.5s to complete
    error(train)=3.41e-01, acc(train)=8.72e-01, error(valid)=4.39e-01, acc(valid)=8.49e-01, error(test)=4.70e-01, acc(test)=8.39e-01
Epoch 15: 205.5s to complete
    error(train)=3.40e-01, acc(train)=8.72e-01, error(valid)=4.35e-01, acc(valid)=8.46e-01, error(test)=4.63e-01, acc(test)=8.37e-01
Epoch 16: 236.7s to complete
    error(train)=3.40e-01, acc(train)=8.73e-01, error(valid)=4.39e-01, acc(valid)=8.50e-01, error(test)=4.64e-01, acc(test)=8.38e-01
Epoch 17: 206.1s to complete
    error(train)=3.57e-01, acc(train)=8.62e-01, error(valid)=4.61e-01, acc(valid)=8.34e-01, error(test)=4.93e-01, acc(test)=8.27e-01
Epoch 18: 207.4s to complete
    error(train)=2.78e-01, acc(train)=8.93e-01, error(valid)=3.89e-01, acc(valid)=8.66e-01, error(test)=4.13e-01, acc(test)=8.56e-01
Epoch 19: 207.6s to complete
    error(train)=2.77e-01, acc(train)=8.94e-01, error(valid)=3.83e-01, acc(valid)=8.66e-01, error(test)=4.13e-01, acc(test)=8.56e-01
Epoch 20: 208.5s to complete
    error(train)=2.67e-01, acc(train)=8.98e-01, error(valid)=3.78e-01, acc(valid)=8.67e-01, error(test)=4.12e-01, acc(test)=8.55e-01
Epoch 21: 209.2s to complete
    error(train)=3.00e-01, acc(train)=8.83e-01, error(valid)=4.13e-01, acc(valid)=8.54e-01, error(test)=4.45e-01, acc(test)=8.44e-01
Epoch 22: 210.7s to complete
    error(train)=2.80e-01, acc(train)=8.92e-01, error(valid)=4.03e-01, acc(valid)=8.62e-01, error(test)=4.30e-01, acc(test)=8.49e-01
Epoch 23: 211.7s to complete
    error(train)=2.95e-01, acc(train)=8.87e-01, error(valid)=4.12e-01, acc(valid)=8.55e-01, error(test)=4.40e-01, acc(test)=8.46e-01
Epoch 24: 213.8s to complete
    error(train)=2.85e-01, acc(train)=8.90e-01, error(valid)=4.08e-01, acc(valid)=8.59e-01, error(test)=4.36e-01, acc(test)=8.46e-01
Epoch 25: 215.3s to complete
    error(train)=3.24e-01, acc(train)=8.77e-01, error(valid)=4.48e-01, acc(valid)=8.48e-01, error(test)=4.77e-01, acc(test)=8.37e-01
Epoch 26: 216.3s to complete
    error(train)=2.71e-01, acc(train)=8.93e-01, error(valid)=4.01e-01, acc(valid)=8.60e-01, error(test)=4.30e-01, acc(test)=8.48e-01
Epoch 27: 217.6s to complete
    error(train)=2.67e-01, acc(train)=8.95e-01, error(valid)=3.91e-01, acc(valid)=8.61e-01, error(test)=4.22e-01, acc(test)=8.50e-01
Epoch 28: 219.2s to complete
    error(train)=3.03e-01, acc(train)=8.83e-01, error(valid)=4.37e-01, acc(valid)=8.51e-01, error(test)=4.64e-01, acc(test)=8.42e-01
Epoch 29: 219.2s to complete
    error(train)=2.55e-01, acc(train)=9.00e-01, error(valid)=3.88e-01, acc(valid)=8.64e-01, error(test)=4.20e-01, acc(test)=8.54e-01
Epoch 30: 220.0s to complete
    error(train)=2.87e-01, acc(train)=8.90e-01, error(valid)=4.16e-01, acc(valid)=8.58e-01, error(test)=4.43e-01, acc(test)=8.48e-01
Epoch 31: 219.9s to complete
    error(train)=2.69e-01, acc(train)=8.95e-01, error(valid)=3.94e-01, acc(valid)=8.61e-01, error(test)=4.28e-01, acc(test)=8.49e-01
Epoch 32: 219.7s to complete
    error(train)=2.94e-01, acc(train)=8.87e-01, error(valid)=4.26e-01, acc(valid)=8.54e-01, error(test)=4.57e-01, acc(test)=8.41e-01
Epoch 33: 220.0s to complete
    error(train)=2.54e-01, acc(train)=9.01e-01, error(valid)=3.87e-01, acc(valid)=8.66e-01, error(test)=4.21e-01, acc(test)=8.52e-01
Epoch 34: 219.6s to complete
    error(train)=2.36e-01, acc(train)=9.07e-01, error(valid)=3.74e-01, acc(valid)=8.69e-01, error(test)=4.07e-01, acc(test)=8.58e-01
Epoch 35: 219.4s to complete
    error(train)=2.78e-01, acc(train)=8.93e-01, error(valid)=4.10e-01, acc(valid)=8.59e-01, error(test)=4.44e-01, acc(test)=8.46e-01
Epoch 36: 220.6s to complete
    error(train)=2.69e-01, acc(train)=8.94e-01, error(valid)=4.18e-01, acc(valid)=8.57e-01, error(test)=4.47e-01, acc(test)=8.46e-01
Epoch 37: 220.4s to complete
    error(train)=2.70e-01, acc(train)=8.94e-01, error(valid)=4.10e-01, acc(valid)=8.59e-01, error(test)=4.41e-01, acc(test)=8.44e-01
Epoch 38: 220.5s to complete
    error(train)=2.70e-01, acc(train)=8.94e-01, error(valid)=4.12e-01, acc(valid)=8.57e-01, error(test)=4.51e-01, acc(test)=8.48e-01
Epoch 39: 220.3s to complete
    error(train)=2.53e-01, acc(train)=9.02e-01, error(valid)=3.95e-01, acc(valid)=8.65e-01, error(test)=4.27e-01, acc(test)=8.52e-01
Epoch 40: 220.4s to complete
    error(train)=2.52e-01, acc(train)=8.99e-01, error(valid)=4.03e-01, acc(valid)=8.62e-01, error(test)=4.40e-01, acc(test)=8.51e-01
Epoch 41: 223.1s to complete
    error(train)=3.20e-01, acc(train)=8.80e-01, error(valid)=4.70e-01, acc(valid)=8.41e-01, error(test)=5.09e-01, acc(test)=8.30e-01
Epoch 42: 223.0s to complete
    error(train)=2.55e-01, acc(train)=9.00e-01, error(valid)=4.00e-01, acc(valid)=8.62e-01, error(test)=4.33e-01, acc(test)=8.51e-01
Epoch 43: 221.4s to complete
    error(train)=2.53e-01, acc(train)=9.01e-01, error(valid)=4.08e-01, acc(valid)=8.61e-01, error(test)=4.44e-01, acc(test)=8.50e-01
Epoch 44: 220.8s to complete
    error(train)=2.47e-01, acc(train)=9.03e-01, error(valid)=3.96e-01, acc(valid)=8.63e-01, error(test)=4.26e-01, acc(test)=8.51e-01
Epoch 45: 220.9s to complete
    error(train)=2.70e-01, acc(train)=8.94e-01, error(valid)=4.23e-01, acc(valid)=8.56e-01, error(test)=4.55e-01, acc(test)=8.45e-01
Epoch 46: 220.3s to complete
    error(train)=2.75e-01, acc(train)=8.92e-01, error(valid)=4.25e-01, acc(valid)=8.54e-01, error(test)=4.66e-01, acc(test)=8.43e-01
