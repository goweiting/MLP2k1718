Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_1layer.py", line 3, in <module>
    from mlp.helper import train_model_and_plot_stats
ImportError: No module named mlp.helper
  File "Coursework_2-PART-B-baseline_1layer-BNDROPOUT.py", line 69
    ReluLayer(),
            ^
SyntaxError: invalid syntax
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_1layer-BNDROPOUT.py", line 89, in <module>
    patience=5)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/helper.py", line 166, in train_model_and_plot_stats
    output = optimiser.train(num_epochs, stats_interval)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 324, in train
    self.do_training_epoch()
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 224, in do_training_epoch
    self.learning_rule.update_params(grads_wrt_params)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/learning_rules.py", line 235, in update_params
    m += (1. - self.beta_1) * grad
ValueError: non-broadcastable output operand with shape (720,) doesn't match the broadcast shape (47,720)
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_1layer-BNDROPOUT.py", line 91, in <module>
    patience=5)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/helper.py", line 166, in train_model_and_plot_stats
    output = optimiser.train(num_epochs, stats_interval)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 312, in train
    epoch_stat, param_stat = self.get_epoch_stats()  # this will evaluate the model!
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 267, in get_epoch_stats
    epoch_stats.update(self.eval_monitors(self.train_dataset, '(train)'))
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 243, in eval_monitors
    activations = self.model.fprop(inputs_batch, evaluation=True)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/models.py", line 103, in fprop
    current_activations = self.layers[i].fprop(activations[i], stochastic=False)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/layers.py", line 593, in fprop
    return norm*self.gamma + self.beta
ValueError: operands could not be broadcast together with shapes (100,400) (720,) 
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_1layer-BNDROPOUT.py", line 91, in <module>
    patience=5)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/helper.py", line 166, in train_model_and_plot_stats
    output = optimiser.train(num_epochs, stats_interval)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 324, in train
    self.do_training_epoch()
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 224, in do_training_epoch
    self.learning_rule.update_params(grads_wrt_params)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/learning_rules.py", line 235, in update_params
    m += (1. - self.beta_1) * grad
ValueError: non-broadcastable output operand with shape (400,) doesn't match the broadcast shape (47,400)
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_1layer-BNDROPOUT.py", line 91, in <module>
    patience=5)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/helper.py", line 166, in train_model_and_plot_stats
    output = optimiser.train(num_epochs, stats_interval)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 324, in train
    self.do_training_epoch()
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 224, in do_training_epoch
    self.learning_rule.update_params(grads_wrt_params)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/learning_rules.py", line 73, in update_params
    param -= self.learning_rate * grad
ValueError: non-broadcastable output operand with shape (400,) doesn't match the broadcast shape (47,400)
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_1layer-BNDROPOUT.py", line 91, in <module>
    patience=5)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/helper.py", line 166, in train_model_and_plot_stats
    output = optimiser.train(num_epochs, stats_interval)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 324, in train
    self.do_training_epoch()
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 224, in do_training_epoch
    self.learning_rule.update_params(grads_wrt_params)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/learning_rules.py", line 73, in update_params
    param -= self.learning_rate * grad
ValueError: non-broadcastable output operand with shape (400,) doesn't match the broadcast shape (47,400)
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_1layer-BNDROPOUT.py", line 92, in <module>
    patience=5)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/helper.py", line 166, in train_model_and_plot_stats
    output = optimiser.train(num_epochs, stats_interval)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 312, in train
    epoch_stat, param_stat = self.get_epoch_stats()  # this will evaluate the model!
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 267, in get_epoch_stats
    epoch_stats.update(self.eval_monitors(self.train_dataset, '(train)'))
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 243, in eval_monitors
    activations = self.model.fprop(inputs_batch, evaluation=True)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/models.py", line 105, in fprop
    current_activations = self.layers[i].fprop(activations[i])
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/layers.py", line 376, in fprop
    return self.weights.dot(inputs.T).T
ValueError: shapes (400,720) and (400,100) not aligned: 720 (dim 1) != 400 (dim 0)
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
Traceback (most recent call last):
  File "Coursework_2-PART-B-baseline_1layer-BNDROPOUT.py", line 92, in <module>
    patience=5)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/helper.py", line 166, in train_model_and_plot_stats
    output = optimiser.train(num_epochs, stats_interval)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 324, in train
    self.do_training_epoch()
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/optimisers.py", line 224, in do_training_epoch
    self.learning_rule.update_params(grads_wrt_params)
  File "/afs/inf.ed.ac.uk/user/s14/s1450710/MLP2k1718/mlp/learning_rules.py", line 73, in update_params
    param -= self.learning_rate * grad
ValueError: non-broadcastable output operand with shape (400,) doesn't match the broadcast shape (47,400)
Epoch 1: 185.0s to complete
    error(train)=7.48e-01, acc(train)=7.70e-01, error(valid)=7.61e-01, acc(valid)=7.63e-01, error(test)=7.92e-01, acc(test)=7.56e-01
Epoch 2: 185.1s to complete
    error(train)=5.92e-01, acc(train)=8.11e-01, error(valid)=6.17e-01, acc(valid)=8.03e-01, error(test)=6.45e-01, acc(test)=7.94e-01
Epoch 3: 187.3s to complete
    error(train)=5.19e-01, acc(train)=8.31e-01, error(valid)=5.50e-01, acc(valid)=8.23e-01, error(test)=5.82e-01, acc(test)=8.14e-01
Epoch 4: 185.7s to complete
    error(train)=4.80e-01, acc(train)=8.42e-01, error(valid)=5.18e-01, acc(valid)=8.32e-01, error(test)=5.51e-01, acc(test)=8.20e-01
Epoch 5: 186.5s to complete
    error(train)=4.48e-01, acc(train)=8.54e-01, error(valid)=4.92e-01, acc(valid)=8.38e-01, error(test)=5.26e-01, acc(test)=8.29e-01
Epoch 6: 185.4s to complete
    error(train)=4.43e-01, acc(train)=8.53e-01, error(valid)=5.00e-01, acc(valid)=8.35e-01, error(test)=5.27e-01, acc(test)=8.27e-01
Epoch 7: 185.9s to complete
    error(train)=4.14e-01, acc(train)=8.60e-01, error(valid)=4.74e-01, acc(valid)=8.45e-01, error(test)=5.04e-01, acc(test)=8.31e-01
Epoch 8: 185.7s to complete
    error(train)=4.04e-01, acc(train)=8.63e-01, error(valid)=4.71e-01, acc(valid)=8.42e-01, error(test)=5.01e-01, acc(test)=8.33e-01
Epoch 9: 183.8s to complete
    error(train)=4.05e-01, acc(train)=8.61e-01, error(valid)=4.75e-01, acc(valid)=8.41e-01, error(test)=5.12e-01, acc(test)=8.31e-01
Epoch 10: 185.0s to complete
    error(train)=3.80e-01, acc(train)=8.76e-01, error(valid)=4.57e-01, acc(valid)=8.51e-01, error(test)=4.85e-01, acc(test)=8.43e-01
Epoch 11: 185.6s to complete
    error(train)=3.93e-01, acc(train)=8.64e-01, error(valid)=4.80e-01, acc(valid)=8.41e-01, error(test)=5.12e-01, acc(test)=8.31e-01
Epoch 12: 184.6s to complete
    error(train)=3.95e-01, acc(train)=8.65e-01, error(valid)=4.87e-01, acc(valid)=8.39e-01, error(test)=5.21e-01, acc(test)=8.31e-01
Epoch 13: 184.5s to complete
    error(train)=3.98e-01, acc(train)=8.67e-01, error(valid)=4.94e-01, acc(valid)=8.39e-01, error(test)=5.28e-01, acc(test)=8.24e-01
Epoch 14: 186.7s to complete
    error(train)=3.78e-01, acc(train)=8.74e-01, error(valid)=4.77e-01, acc(valid)=8.44e-01, error(test)=5.12e-01, acc(test)=8.30e-01
Epoch 15: 185.9s to complete
    error(train)=4.02e-01, acc(train)=8.62e-01, error(valid)=5.08e-01, acc(valid)=8.30e-01, error(test)=5.46e-01, acc(test)=8.20e-01
Epoch 16: 185.9s to complete
    error(train)=3.42e-01, acc(train)=8.82e-01, error(valid)=4.48e-01, acc(valid)=8.51e-01, error(test)=4.80e-01, acc(test)=8.42e-01
Epoch 17: 185.2s to complete
    error(train)=3.81e-01, acc(train)=8.68e-01, error(valid)=5.00e-01, acc(valid)=8.34e-01, error(test)=5.33e-01, acc(test)=8.23e-01
UP1: error(valid) at 17 = 5.00e-01 > at 12 = 4.87e-01
UP2: error(valid) at 12 = 4.87e-01 > at 7 = 4.74e-01
Epoch 18: 185.6s to complete
    error(train)=3.75e-01, acc(train)=8.67e-01, error(valid)=5.01e-01, acc(valid)=8.33e-01, error(test)=5.33e-01, acc(test)=8.26e-01
UP1: error(valid) at 18 = 5.01e-01 > at 13 = 4.94e-01
UP2: error(valid) at 13 = 4.94e-01 > at 8 = 4.71e-01
Epoch 19: 185.5s to complete
    error(train)=4.02e-01, acc(train)=8.57e-01, error(valid)=5.33e-01, acc(valid)=8.21e-01, error(test)=5.70e-01, acc(test)=8.13e-01
UP1: error(valid) at 19 = 5.33e-01 > at 14 = 4.77e-01
UP2: error(valid) at 14 = 4.77e-01 > at 9 = 4.75e-01
Epoch 20: 185.4s to complete
    error(train)=3.75e-01, acc(train)=8.68e-01, error(valid)=5.13e-01, acc(valid)=8.32e-01, error(test)=5.51e-01, acc(test)=8.23e-01
UP1: error(valid) at 20 = 5.13e-01 > at 15 = 5.08e-01
UP2: error(valid) at 15 = 5.08e-01 > at 10 = 4.57e-01
Epoch 21: 185.6s to complete
    error(train)=3.88e-01, acc(train)=8.62e-01, error(valid)=5.32e-01, acc(valid)=8.27e-01, error(test)=5.68e-01, acc(test)=8.17e-01
UP1: error(valid) at 21 = 5.32e-01 > at 16 = 4.48e-01
Epoch 22: 184.8s to complete
    error(train)=3.86e-01, acc(train)=8.68e-01, error(valid)=5.23e-01, acc(valid)=8.28e-01, error(test)=5.54e-01, acc(test)=8.17e-01
UP1: error(valid) at 22 = 5.23e-01 > at 17 = 5.00e-01
UP2: error(valid) at 17 = 5.00e-01 > at 12 = 4.87e-01
UP3: error(valid) at 12 = 4.87e-01 > at 7 = 4.74e-01
EARLY STOPPING
['inputs', 'targets']
['inputs', 'targets']
['inputs', 'targets']
